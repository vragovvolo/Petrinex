resources:
  jobs:
    petrinex_job:
      name: petrinex_job

      trigger:
        periodic: # Run weekly to ensure we catch updates
          interval: 1
          unit: WEEKS

      email_notifications:
        on_failure:
          - scott.mckean@databricks.com

      tasks:
        - task_key: ingest
          environment_key: default
          notebook_task:
            notebook_path: ../src/01_ingest.ipynb

        - task_key: process
          environment_key: default
          notebook_task:
            notebook_path: ../src/02_process.ipynb
          depends_on:
            - task_key: ingest

        - task_key: forecast
          environment_key: default
          notebook_task:
            notebook_path: ../src/03_forecast.ipynb
          depends_on:
            - task_key: process

      environments:
        - environment_key: default
          spec:
            environment_version: "3"
            dependencies:
              - ../dist/*.whl
